val register : int -> string -> string -> string -> unit
val flush : (string -> unit)  -> string -> string -> unit
