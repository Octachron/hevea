\documentclass[a4paper]{article}

\usepackage{html}
\usepackage{isolatin1}
\usepackage{a4wide}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\newcommand{\commandname}[1]{{\tt #1}}
\newcommand{\filename}[1]{{\em #1}}
\newcommand{\urlex}[1]{\url{\docurl/examples/#1}{\filename{#1}}}

\begin{latexonly}
\gdef\myrule{\rule{10cm}{.05ex}}
\gdef\htmlout{\begingroup\parskip=0pt\parindent=0pt\begin{quote}\myrule\par}
\gdef\endhtmlout{\par\myrule\end{quote}\endgroup}
\end{latexonly} 
\begin{htmlonly}
\gdef\myrule{\@print{<HR NOSHADE SIZE=1 ALIGN=left WIDTH=75%>
}}%
\gdef\htmlout{\begin{quote}\myrule}
\gdef\endhtmlout{\myrule\end{quote}}
\end{htmlonly}
\newenvironment{latexout}{\begin{htmlout}}{\end{htmlout}}


\title{\hevea{} user documentation}
\author{Luc Maranget\thanks{Inria Rocquencourt -- BP 105, 78153 Le
Chesnay Cedex. {\tt \mail{Luc.Maranget}{inria.fr}}}}

\setcounter{cuttingdepth}{2}
\begin{document}

\maketitle

\begin{abstract}
{\hevea} is a {\LaTeX} to
{\html} translator.
The input language is a fairly complete subset of \LaTeX2e\ (old
\LaTeX\ style is also accepted) and the
output langaguage is {\html} that is (hopefullly) correct with respect to
version 3.2.

Mathematics and other exotic symbols are translated into symbols
pertening to the symbol font of the {\html} browser, using the
non-standard \verb+FACE+ atribute of the \verb+FONT+ tag.
This allows the translation to {\html} of quite a lot of the symbols used in
\LaTeX.


{\hevea} understands {\LaTeX} macro definitions. This allows to use user style
files with little or no modifications.
This also allow customizing {\hevea} by writting {\LaTeX} code.


{\hevea} is written in Objective Caml, as many lexers. It is
quite fast and flexible.
Using {\hevea} it is possible to translate  big documents such
as manuals, books, etc. very quickly. All documents are
translated as one single {\html} file. Then, the output file can be cut into
smaller files, using the companion program \htmlcut.
\end{abstract}


\newpage
\tableofcontents

\clearpage
\part{User manual}

\section{How to get started}\label{getstarted}

Assume that you have a file \filename{a.tex} written in \LaTeX, using the
\filename{article}, \filename{book} or \filename{report} style. Then,
translation
is achieved by issuing the command~:
\begin{verbatim}
     hevea a.tex
\end{verbatim}
Probably, you will get some warnings about unknown macros. If
\hevea\ does not crash, just ignore them for the moment
(Section~\ref{trouble}  explains how to correct errors).

If everything goes fine, this will produce a new file
``\filename{a.html}'' that you can visualize using an {\html} brower.
If \filename{a.tex} contains maths symbols you need to instruct your
browser to use symbol fonts (see section~\ref{browser}).

If you wish to experiment \hevea\ on small \LaTeX\ source fragments,
then lauch \hevea\ without arguments. \hevea\ will read its
standard input and print the translation on its standard output.
For instance:
\begin{verbatim}
# hevea
$
x \in {\cal E}
$
^D
<I>
x <FONT FACE=symbol>Î</FONT> </I><I><FONT COLOR=red> E</FONT></I><I>
</I>
\end{verbatim}

You can find some \url{\docurl/examples/}{examples} in the on-line
documentation, including examples of \urlex{a.tex} and
\urlex{a.html} files.

\section{More ambitious translations}

\subsection{Base style files}

\noindent\hevea\ knows about two {\LaTeX} base style file,
\filename{article} and \filename{book}.
Additionnaly, the \filename{report} base style is recognized and
considerd equivalent to \filename{book}. In case your source file uses
another base style, then you can instruct {\hevea} to load one of the
style files it knows about before processing your source file.
This is done by giving the desired style file as an extra command line
argument.

Let us assume that \filename{mydoc.tex} uses an exotic style
file such as \verb+acmconf+. Then, typing
\verb+hevea mydoc.tex+ may yield two kind of errors.
Either \hevea\ finds the the \filename{acmconf.sty} file (e.g. if you have a
private copy of it in your directory) and fails to
interpret it~:
\begin{verbatim}
# hevea mydoc.tex
./acmconf.sty:84: Unknown macro: \typeout
./acmconf.sty:85: Unknown macro: \typeout
./acmconf.sty:87: Adios
Fatal error: uncaught exception Failure("Bad newif: \if")
\end{verbatim}
Or,  \hevea\ cannot find the \filename{acmconf.sty} file and you get a
lot of warnings:
\begin{verbatim}
# hevea acmarticle.tex
mydoc.tex:9: Unknown macro: \@docpart
mydoc.tex:9: Unknown macro: \@docchapter
mydoc.tex:18: Unknown counter: footnote
...
\end{verbatim}


Both situations are avoided by invoking \verb+hevea+ with a known
base style file  as an extra argument:
\begin{verbatim}
hevea article.sty mydoc.tex
\end{verbatim}
Such an extra argument instructs
\hevea\ to load its \filename{article.sty}
style file before processing \filename{mydoc.tex}
It will then ignore the base style specified by
\verb+\documentstyle+ or \verb+\documentclass+.

\subsection{Other style files}

A \LaTeX\ document usually loads additional style files (using
\verb+\input+ or \verb+\usepackage+, or by giving optional arguments to \verb+\documentstyle+).
\hevea\ simply ignores \verb+\usepackage+ and optional arguments to
\verb+\documentstyle+, but it attempts to load a file given as argument
to \verb+\input+.
(You can see what files {\hevea} loads or attempts to load by using
the \verb+-v+ option.)

A simple situation is when {\hevea} is not happy  with just a few macros
in a style file.
As it is often the case, assume that the document \filename{mydoc.tex} has a
\verb+\input{macros.tex}+ instruction in its preambule, where
\filename{macros.tex} gathers custom definitions.
Hopefully, only a few macros give rise to trouble: macros that performs fine
typesetting or {\TeX}ish macros.
Such macros need to be rewritten, using more basic {\LaTeX}
constructs (section~\ref{trouble} gives examples of macro-rewritting).
The new definition are best collected in a style file,
\filename{mymacros.sty} for instance.
Then, \filename{mydoc.tex} is to be compiled by issuing the command:
\begin{verbatim}
# hevea mymacros.sty mydoc.tex
\end{verbatim}
The file \filename{mymacros.sty} is processed before
\filename{mydoc.tex} (and thus before \filename{macros.tex}).
As a consequence, the macro definitions in \filename{mymacros.tex}
overide the ones in  \filename{macros.tex}, provided the latter are made
using \verb+\newcommand+ or \verb+\def+ (section~\ref{usermacro}
explains how {\hevea} handle macro definitions and redefinitions).

Another situation is when  {\hevea} fails to process a whole 
style file. Usually, this means that {\hevea} crashes on that style
file.
Then, you should also instruct
{\hevea} not to load the faulty file, by issuing the command:
\begin{verbatim}
# hevea mymacros.sty -e macros.tex mydoc.tex
\end{verbatim}
Of course, \filename{mymacros.sty} must now contain replacements for
all the useful macros of \filename{macro.tex}.
Note that another solution to instruct {\LaTeX} to load a file and
{\hevea} not to load it is to use \verb+\usepackage+ or optional
arguments to \verb+\documentstyle+, which {\hevea}
ignore.


As to writting replacement macros,
things get tricky for style files that
significantly extends {\LaTeX} capabilities to typeset inderence rules
or categorical diagrams for instance.
Then, the  solution depends both on {\html} capabilities and on your
willingness to rewrite macros.
However, it is still possible to have {\LaTeX} typeset some subparts of
the document and to include them as images (see section~\ref{imagegen}).

\section{A note on style}

\subsection{Spacing, Paragraphs}
Spacing in the \html{} document reflects the original source spacing.
More precisely, any non empty sequence of spaces is outputed as one
space, whereas a single newline is replicated in the output.
Howhever one  blank line  (i.e., two newlines in a row) or more
intruduce a paragraph break.


Space after macros with no argument is skipped (as in {\LaTeX}) ---
however this is not true in math mode, see below.
Consider the following example:
\begin{verbatim}
\newcommand{\openpar}{(}
\newcommand{\closepar}{)}
\openpar text opened by ``openpar''
and closed by ``closepar''\closepar.
\end{verbatim}
We get:
\begin{quote}
\newcommand{\openpar}{(}
\newcommand{\closepar}{)}
\openpar text opened by ``openpar'' and closed by
``closepar''\closepar.
\end{quote}
In the tpeset example above, the space after \verb+\openpar+ does not
find its way to the output.



By contrast with \LaTeX{}, spaces from the input are significant in
math mode, this
feature allows users to instruct \hevea{}
on how to put space their formulas.
For instance, \verb+\alpha\rightarrow\beta+ is typeset without spaces between
symbols, whereas \verb+\alpha \rightarrow \beta+ produces these spaces:
\begin{htmlonly}
$$
\begin{array}{l@{ : }l}
\verb+\alpha\rightarrow\beta+ & \alpha\rightarrow\beta\\
\verb+\alpha \rightarrow \beta+ & \alpha \rightarrow \beta\\
\end{array}
$$
\end{htmlonly}
Note that \LaTeX{} ignores spaces in math mode, so that users can
freely adjust \hevea{} output without changing anything to \LaTeX{}
output.


\newcommand{\bfsymbol}{\mbox{\bf symbol}}
\begin{htmlonly}
Consider for instance the following command definition:
\begin{verbatim}
\newcommand{\bfsymbol}{\mbox{\bf symbol}}
\end{verbatim}
Using \verb+\bfsymbol+ in text mode, we 
\end{htmlonly}

Not even attempting to be rational about spacing,
\hevea{} try to emulate \LaTeX{} behavior is all situations, but this
discrepancies probably exist.
Thus, users are invited to make explicit what they want.
This is good practice anyway, because \LaTeX{} is mysterious
here. Consider the following example, where the \verb+\tryspace+
macro is first applied and then expansed by hand:
\begin{verbatim}
\newcommand{\tryspace}[1]{#1 XXX}

Some space: \tryspace{\bfsymbol}\\
No space: \bfsymbol XXX
\end{verbatim}
Spacing is a bit chaotic here,
the space after \bfsymbol{} remains when \verb+#1+ is substituted for it
by \LaTeX{} (or \hevea).

\begin{htmlout}
\newcommand{\tryspace}[1]{#1 XXX}
\begin{tabular}{l@{~:~}l}
Some space & \tryspace{\bfsymbol}\\
No space   & \bfsymbol XXX
\end{tabular}
\end{htmlout}
Note that if a space is wanted beetween \verb+XXX+ and whatever \verb+#1+
expands to, one can write:
\begin{verbatim}
\newcommand{\tryspace}[2]{#1{} XXX}
\end{verbatim}

\subsection{Supported symbol}




\section{Definitions}
Just like {\LaTeX}, {\hevea} can be seen as a macro language, macros
are rewritten until no more expansion is possible. Then, either some
caracters (such as letters, integers\ldots) are outputed or some
internal operation (such as changing font attributes, or arranging
text items in a certain manner) are performed.

This scheme favors easy extension of program capabilities
by users. However predicting program behavior and correcting errors
may prove difficult, since final output or errors
may occur after several levels of macro expansion.
As a consequence, users can tailor {\hevea} to their needs, but it
remains a subtle task.
However, happy {\LaTeX} users should enjoy customizing
{\hevea}, since this is done merely by writting {\LaTeX} code.



\subsection{Base macros}
{\LaTeX} and {\html} differ in many aspects. For instance, {\LaTeX} allows
fine control over text placement, whereas
{\html} does not.
More symbols and font attributes are available in \LaTeX\ than in
{\html}. However, {\html} has font attributes, such as color, which
standard {\LaTeX} has not.

As a consequence, there are many situations where {\hevea} just cannot
render the visual effect of {\LaTeX} constructions. Here some choices
have to be made. For instance, the calligraphic letters (\verb+\cal+)
are rendered in red (\verb+<FONT COLOR=red>+), and the small caps
(\verb+\sc+) are rendered in bold font (\verb+<BF>+).

If you are not satisfied with my choices, then you
can make your own choices, by redefining the \verb+\cal+ and \verb+\sc+
macros, using \verb+\renewcommand+, the macro redefinition operator of
{\LaTeX}.
\begin{verbatim}
\renewcommand{\sc}{\large}
\renewcommand{\cal}{\em}
\end{verbatim}



Note that many base macros and environments are defined in the 
\verb+hevea.sty+ file that {\hevea} loads before processing any
input.
These macros are written using {\LaTeX} source code.
Having a look at the \verb+hevea.sty+ file (or at the base style
files of \hevea) will help you in designing your own implementation
of base macros.

Other base macros that require a special processing are defined
in {\hevea} source code.
However, most of these macro definitions can be overiden by a
redefinition.
There remains a small number of macros that cannot be changed.
They either are {\hevea} internal macros that finally output {\html}
or {\LaTeX} core macros and environments, such as \verb+\newcounter+
or \verb+array+.
If you attempt to define or redefine these macros, nothing should happen.


\section{Ignored \LaTeX{} constructs}
As \html{} ignores pages in the paper document sense, all commands
relative to page styles and umbering are ignored.
That is, these commands silently do nothing.




\section{How to detect and correct errors}\label{trouble}

Most of the problems that occur during the translation of a given
{\LaTeX} file (say \verb+trouble.tex+) can be solved at
the macro-level. That is, most problems can be solved by writing a few
macros. The best place for these macros is an user-style file (say
\verb+trouble.sty+) given as
argument to \hevea.
\begin{verbatim}
# hevea trouble.sty trouble.tex
\end{verbatim}
By doing so, the macros written specially for \hevea\ are not
seen by \LaTeX. Even better, \verb+trouble.tex+ is not changed
at all.

Of course, this will be easier if the \LaTeX\ source is written in a
generic style, using macros.
Note that this style is recommended anyway, since it eases the changing
and tuning of documents.

\subsection{\hevea\ does not know a macro}
Consider the following \LaTeX\ source excerpt:
\begin{verbatim}
You can \raisebox{.6ex}{\em raise} text.
\end{verbatim}

{\LaTeX} typesets this as follows:
\begin{htmlout}
\begin{htmlonly}
\begin{toimage}
You can \raisebox{.6ex}{\em raise} text.
\end{toimage}
\imageflush
\end{htmlonly}      
\begin{latexonly}
You can \raisebox{.6ex}{\em raise} text.
\end{latexonly}
\end{htmlout}

Since \hevea\ does not know about \verb+raisebox+,
it uncorrectly processes this input. More precisely,
it first prints a warning message:
\begin{verbatim}
trouble.tex:34: Unknown macro: \raisebox
\end{verbatim}
Then, it goes on by translating the arguments of \verb+\raisebox+ as
there were normal text. As a
consequence some \verb+.6ex+ is finally found in the {\html} output:
\begin{htmlout}
\begin{latexonly}
You can .6ex{\em raise} text.
\end{latexonly}
\begin{htmlonly}
You can \raisebox{.6ex}{\em raise} text.
\end{htmlonly}
\end{htmlout}

To correct this, you should provide a macro that more or less has the effect of
\verb+raisebox+. It is difficult, yet impossible, to write a generic
\verb+raisebox+ macro for \hevea. However, in this case, the effect
of \verb+\raisebox+ is to raise the box {\em a little}.
Thus, the first, numerical, argument to \verb+\raisebox+  can be
ignored in a private \verb+\raisebox+ macro defined in \filename{trouble.sty}:
\begin{verbatim}
\newcommand{\raisebox}[2]{$^{\mbox{#2}}$}
\end{verbatim}

Now, tranlating the document yields:
\begin{htmlout}
\renewcommand{\raisebox}[2]{$^{\mbox{#2}}$}%
You can \raisebox{.6ex}{\em raise} text a little.
\end{htmlout}

Of course, this will work only when all \verb+\raisebox+ in the document
raise text a little. Consider, for instance, this example, where text
is both raised a lowered a little:
\begin{verbatim}
You can \raisebox{.6ex}{\em raise} or \raisebox{-.6ex}{\em lower} text.
\end{verbatim}
Which \LaTeX, renders as follows:
\begin{htmlout}
\begin{htmlonly}
%% BEGIN IMAGE
You can \raisebox{.6ex}{\em raise} or \raisebox{-.6ex}{\em lower} text.
%% END IMAGE
\imageflush
\end{htmlonly}
\begin{latexonly}
You can \raisebox{.6ex}{\em raise} or \raisebox{-.6ex}{\em lower} text.
\end{latexonly}
\end{htmlout}
Whereas, with the above definition of \verb+\raisebox+, \hevea\ produces:
\begin{htmlout}
\renewcommand{\raisebox}[2]{$^{\mbox{#2}}$}%
You can \raisebox{.6ex}{\em raise} or \raisebox{-.6ex}{\em lower} text.
\end{htmlout}


A solution is to add a new macro definition in the \verb+trouble.sty+ file:
\begin{verbatim}
\newcommand{\lowerbox}[2]{$_{\mbox{#2}}$}
\end{verbatim}
Then, \verb+trouble.tex+ itself has to be modified a little.
\begin{verbatim}
You can \raisebox{.6ex}{\em raise} or \lowerbox{-.6ex}{\em lower} text.
\end{verbatim}
{\hevea} now produces a satisfying output:
\begin{htmlout}
\begin{latexonly}\renewcommand{\raisebox}[2]{$^{\mbox{#2}}$}%
\newcommand{\lowerbox}[2]{$_{\mbox{#2}}$}
You can \raisebox{.6ex}{\em raise} or \lowerbox{-.6ex}{\em lower} text.
\end{latexonly}
\begin{htmlonly}\newcommand{\raisebox}[2]{$^{\mbox{#2}}$}%
\newcommand{\lowerbox}[2]{$_{\mbox{#2}}$}
You can \raisebox{.6ex}{\em raise} or \lowerbox{-.6ex}{\em lower} text.
\end{htmlonly}
\end{htmlout}

\subsection{\hevea\ uncorrectly interprets a macro}

Sometimes \hevea\ knows about a macro, but the produced {\html}
is obviously wrong.
This kind of errors is a little more difficult to detect than the
previous one because the translator does not issue a warning. Here you
have to look at the output.
Consider, for instance, this definition:
\begin{verbatim}
\newcommand{\blob}{\rule[.2ex]{1ex}{1ex}}
\blob\ Blob \blob
\end{verbatim}
Which \LaTeX typesets as follows:
\begin{latexout}
\begin{htmlonly}
\begin{toimage}\newcommand{\blob}{\rule[.2ex]{1ex}{1ex}}
\blob\ Blob \blob
\end{toimage}
\imageflush
\end{htmlonly}
\end{latexout}
\hevea\ always translate \verb+\rule+ as \verb+<HR>+, ignoring size
arguments.
Hence, it here produces the following, wrong, output:
\begin{htmlout}\newcommand{\blob}{\rule[.2ex]{1ex}{1ex}}
\begin{htmlonly}
\blob\ Blob \blob
\end{htmlonly}
\end{htmlout}

There is not small square in the symbol font used by \hevea.
However there are other small symbols that would perfectly do the job
of \verb+\blob+, such as a small bullet (\verb+\bullet+ in \LaTeX).
Thus you may choose to give \verb+\blob+ a shadowing definition in
\verb+trouble.sty+:
\begin{verbatim}
\newcommand{\blob}{\bullet}
\end{verbatim}
This new definition yields the following, more satisfying output:
\begin{htmlout}\newcommand{\blob}{\bullet}
\begin{htmlonly}
\blob\ Blob \blob
\end{htmlonly}
\end{htmlout}

\subsection{\hevea\ crashes}

Such an errors may have many causes, including a bug in \hevea.
However, it may also steem from a wrong \LaTeX\ input.
Thus this section is to be read before reporting a bug\ldots

In  the following source, environments are not properly balanced:
\begin{verbatim}
\begin{flushright}
\begin{quote}
This is right-flushed quoted text.
\end{flushright}
\end{quote}
\end{verbatim}
Such a source will make both {\LaTeX} and {\hevea} choke.
Thus, when {\hevea} crashes, it is a good idea to check that the
input is correct by running {\LaTeX} on it.


Unfortunatly, {\hevea} may crash on input that does not affect
\LaTeX.
Such errors are likely to appear when processiong {\TeX}ish input,
such as found in style files.
Consider for instance the following ``optimized'' version of a
\verb+quoteright+  environment:
\begin{verbatim}
\newenvironment{quotebis}{\quote\flushright}{\endquote}

\begin{quotebis}
This a right-flushed quotation
\end{quotebis}
\end{verbatim}

{\LaTeX} produces the expected output:
\begin{latexout}
\begin{toimage}
\newenvironment{quotebis}{\quote\flushright}{\endquote}
\begin{quotebis}
This is a right-flushed quotation
\end{quotebis}
\end{toimage}\imageflush[ALIGN=right]\par
\end{latexout}

However, as {\hevea} often translates {\LaTeX} environments by {\html}
opening and  closing tags  and refuses to generate obviously
non-correct {\html}, it crashes:
\begin{verbatim}
trouble.tex:8: Adios
Fatal error: uncaught exception Failure("hml: BLOCKQUOTE closes DIV")
\end{verbatim}

In this case the solution is easy: environments must be opened and
closed consistently. {\LaTeX} style being recommended, one should write:
\begin{verbatim}
\newenvironment{quotebis}
  {\begin{quote}\begin{flushright}}
  {\end{flushright}\end{quote}}
\end{verbatim}
And we get:
\begin{htmlout}\newenvironment{quotebis}{\begin{quote}\begin{flushright}}{\end{flushright}\end{quote}}
\begin{quotebis}
This is a right-flushed quotation
\end{quotebis}
\end{htmlout}

\section{Cross references}

\subsection{Labels, references}


\subsection{Bibliography}

\subsection{Footnotes}
The commands \verb+\footnote+,
\verb+\footnotetext+ and \verb+\footnotemark+ (with or without
optional arguments) are supported.
The \verb+footnote+ counter exists and (re)setting it or redefining
\verb+\thefootnote+ should work properly.

Footnotes appear at document end in the \filename{article} style and
at every chapter end in the \filename{book} style.
If the document is then cut into smaller files by {\htmlcut} (see
section~\ref{htmlcut}) footnotes may go to a separate file.

Footnotes are bad.
If you want to suppress them, redefine \verb+\footnote+ as follows:
\begin{verbatim}
\renewcommand{\footnote}[2][]{}
\end{verbatim}
If you want to put then in the text flow,  redefine \verb+\footnote+
as follows:
\begin{verbatim}
\renewcommand{\footnote}[2][]{~(#2)}
\end{verbatim}

\subsection{Indexes}

A TOUT EXPLIQUER

\begin{verbatim}
hevea -idx mydoc.tex
\end{verbatim}


\section{Other \LaTeX{} ``primitives''}



\section{Cutting your document into pieces with {\htmlcut}}\label{htmlcut}
{\hevea} outputs a single \filename{.html} file. This file can be
cut into pieces at various sectionnal units by {\htmlcut}
\subsection{Simple usage}
First generate your {\html} document by applying {\hevea}:
\begin{verbatim}
# hevea mydoc.tex
\end{verbatim}
Then cut \filename{mydoc.html} into pieces by the command:
\begin{verbatim}
# htmlcut mydoc.html
\end{verbatim}
This will generate a simple root file
\filename{index.html}.
This root files holds document title, abstract and a simple table of
contents.
Every item in the table of contents contains a link to or into a file
that holds a ``cutting'' sectional unit.
By default, the cutting sectional unit is {\em section} in the
\filename{article} style and {\em chapter} in the \filename{book}
style.

Additionaly, one level of sectionning below the cutting unit (i.e.,
subsections in the \filename{article} style and sections in the
\filename{book} style) is shown
as an entry in the table of contents.
Sectional units above the cutting section (i.e. parts in both
\filename{article} and \filename{book} styles) close the current table
of contents and open a new one.

Cross-references are properly handled, the local links generated by
{\hevea} are changed into distant links.

The name of the root  file can be changed using the
\verb+-o+ option:
\begin{verbatim}
# hevea -o root.html mydoc.html
\end{verbatim}

\subsection{Advanced usage}

{\htmlcut} behavior can be altered by using
a counter and a few macros, directly in the {\LaTeX} document source.

A document that explicitly includes cutting macros still can be typeset by
{\LaTeX}, provided it loads the
\filename{html} package from the {\hevea} distribution.
(See section~\ref{both} for details on the \filename{html.sty} style file).
An alternative to loading the \filename{html} package is to put
all cutting instructions in comments starting with \verb+%HEVEA+.



\subsubsection{Principle}
{\htmlcut} recognizes five sectional units, ordered as follows, from
top to bottom: {\em
part}, {\em chapter},
{\em section}, {\em subsection} and {\em subsubection}.

At any point between \verb+\begin{document}+ and
\verb+\end{document}+,
there exist a current cutting sectional unit (cutting unit for short),
a current cutting depth, a root file and an output file.
Table of contents output goes to the root file, normal output goes to
the output file.
Cutting units start a new output file, whereas units comprised between the
cuttting unit and the cutting units plus the cutting depth add new
entries in the table of contents.

At document start, the root file and the output file are {\htmlcut}
output file (i.e., \filename{index.html}).
The cutting unit and the cutting depth are set to default values that
depend on the document style.

\subsubsection{Cutting macros}
The following cutting instructions are for use in the document
preambule. They command the cutting scheme of the whole document:
\begin{description}
\item[{\tt\char92 cuttingunit}]
This is a macro that holds the document cutting unit. You can change
the default (which is {\em section} in the \filename{article} style
and {\em chapter} in the \filename{book} style)  by doing
\verb+\renewcommand{\cuttingunit}{+{\it secname}\verb+}+.
\item[{\tt cuttingdepth}]
This is a counter that holds the document cutting depth.
You can change the default value of 1 by doing
\verb+\setcounter{cuttingdepth}{+{\it numvalue}\verb+}+.
A cutting depth of zero means no other entries than the cutting units
in the table of contents.
\end{description}

Other cutting instructions are to be used after
\verb+\begin{document}+. They all generate comments in {\hevea}
output.
These comments act as instructions to {\htmlcut}.

\begin{description}
\item[{\tt\char92 cuthere\{}{\it secname}{\tt\}\{}{\it itemtitle}{\tt\}}]
   Attempt a cut.
   \begin{itemize}
   \item If {\it secname} is the current cutting  unit or if {\it
   secname is ``now''}, then
   a new output file is started and an entry in the current table of contents
   is generated, with title {\it itemtitle}. This entry holds a link
   to the new output file.
   \item If {\it secname} is above the cutting  unit, then the
   current table of contents is closed. The output file is set to the
   current root file.
   \item If {\it secname} is below the cutting  unit and less than the
   cutting depth away from it, then an entry is added in the table of
   contents.
   This entry contains {\em itemtitle} and a link to the point where
   \verb+\cuthere+ appears.
   \item Otherwise, no action is performed.
   \end{itemize}

\item[{\tt\char92 cutdef[}{\it depth}{\tt]\{}{\it secname}{\tt \}}]
   Open a new table of contents, with cutting depth~{\em depth} and
   cutting unit {\em secname}. If the optional {\em depth} is absent,
   the cutting depth does not change.
   The output file becomes the root file.
   Result is unspecified if whatever {\em secname} expands to is an
   a sectional unit name above
   the current cutting  unit, is not a valid sectional unit name or if
   {\em depth} does not expand to a small positive number.
\item[{\tt\char92 cutend}]
   End the current table of contents. This closes the scope of the
   previous \verb+\cutdef+. The cutting unit and cutting depth are
   restored.
   Note that \verb+\cutdef+ and \verb+\cutend+ must be properly balanced.
\end{description}

Default settings work as follows:
\verb+\begin{document}+ performs \verb+\cutdef[\value{cuttingdepth}]{\cuttingunit}+ and \verb+\end{document}+
performs \verb+\cutend+.
All sectionning commands down to \verb+\subsubsection+ perform \verb+\cuthere+,
with the sectional unit name as first argument and the (optional, if
present) sectioning
command argument (i.e., the section title) as second argument.
Note that started versions of the sectioning commands also perform
cutting instructions.

\subsubsection{Examples}

Consider, for instance, a \filename{book} document with a long chapter
that you want to cut at the section level, showing subsections:
\begin{verbatim}
\chapter{A long chapter}
.....

\chapter{The next chapter}
\end{verbatim}
Then, you should insert a \verb+\cutdef+ at chapter start and a
\verb+\cutend+ at chapter end:
\begin{verbatim}
\chapter{A long chapter}
\cutdef[1]{section}
.....
\cutend
\chapter{The next chapter}
\end{verbatim}
The macro \verb+section+ already performs the appropriate
\verb+\cuthere{section}{...}+ commands. As a consequence, the file
that would otherwise contain the long chapter now contains the chapter
title and a table of sections.

The \verb+\cuthere+ macro can be used to put some document parts into
their own file.
This may prove appropriate for long cover pages or abstracts that would
otherwise go into the root file.
Consider the following document:
\begin{verbatim}
\documentclass{article}

\begin{document}

\begin{abstract} A big abstract \end{abstract}
...
\end{verbatim}

Then, you make the abstract go to its own file as it was a cutting
unit by typing:
\begin{verbatim}
\documentclass{article}
\usepackage{html}

\begin{document}
\cuthere{\cuttingunit}{Abstract}
\begin{abstract} A big abstract \end{abstract}
...
\end{verbatim}

\part{Reference manual}

This part follows the pattern of the {\LaTeX} reference
manual~\cite[Appendix~C]{latex}.

\section{Sentences and paragraph}

\subsection{Spacing}
Generally speaking, spaces (and single newline characters) in the
source are echoed in the output.  Browser then manage with spaces and
linebreaks.  Following \LaTeX{} behavior, spaces after commands are
not echoed.  Spaces after invisible commands with arguments are not
echoed either.


See also section~\ref{spacemath} on spaces in math mode.


\subsection{Paragraphs}
New paragraphs are introduced by one blank line or more.
Paragraphs are not indented. Thus the macros \verb+\indent+ and
\verb+noinent+ perform no action.

\subsection{Accents and special symbols}
When there exist an equivalent to a given \LaTeX{} symbol, using
the iso-latin1 and symbol character sets, then {\hevea} outputs such
an equivalent.
Otherwise, {\hevea} usually issues a warning to draw user attention.
Users can then choose their own equivalent for the symbol.

Commands for making accents used in non-english languages, such as
\verb+\'+, work when then produce letters from the iso-latin1 character set.
Otherwise, the argument to the command is not modified (no warning here).
However, it is more simple to write the document using iso-latin1.
\LaTeX{} can process such documents by loading the package
\filename{isolatin1}.

\section{Sectioning}

\subsection{Sectioning commands}
Sectioning commands from \verb+\part+ down to
\verb+\subparagraph+ are defined in base style files.
They accept an optional argument and have starred versions.


The non-starred sectionning commands show a section numbers in sectional
unit headings,
from \verb+\part+ down to \verb+\subsubsection+.
This behavoir cannot be changed and
the \verb+secnumdepth+ counter does not exist.
However, given a sectionnal unit {\it secname}, the counter
{\it secname} exists and
the appearance of sectional units numbers can be changed
by redefining \verb+\the+{\it secname}.


\subsection{The Appendix}
The \verb+\appendix+ command exists and should work as in \LaTeX.

\subsection{Table of Contents}
\hevea does not generate a table of contents and all table of contents
related commands such as \verb+\tableofcontents+ or
\verb+\addcontentsline+ do nothing.

However, a later run of {\htmlcut} on \hevea{} output file splits it
in smaller files organized in a tree whose nodes are tables of
contents.
By contrast with \LaTeX{}, starred sectioning commands generate
entries in these tables of contents.
Table of content entries hold the optional argument to sectioning
commands or their argument when there is no optional
argument. Section~\ref{htmlcut} explains how to
control {\htmlcut}.

There is no list of figures nor list of tables.

\section{Classes, Packages and Page Styles}

\subsection{Document Class}
Both \LaTeX2e{} \verb+\documentclass+ and old \LaTeX{}
\verb+\documentstyle+ are accepted.
Their argument {\it style} is interpreted by attempting to load a
\filename{style.sty} file (see~\ref{files} to see where \hevea{}
searches its files).
Presently, only the style files \filename{article.sty},
\filename{book.sty} and \filename{report.sty} exist, the latter two
being the same file.

If one of the three styles has already been loaded at the time when
\verb+\documentclass+ or
\verb+\documentstyle+ is executed, then no attempt to load a style
file is made.

\subsection{Packages and Page Styles}
They are ignored. Related commands do nothing.
As a consequence, style files that are relevant to \hevea{} sould be
loaded using the \verb+\input+ command.
Note, however, \verb+\usepackage+ commands are echoed to the \filename{image}
file (see~\ref{image}).

\subsection{The Title Page and Abstract}
All title related commands exist, with the following peculiarities:
\begin{itemize}
  \item The \verb+\title+ command must appear in the preambule for the title
to appear in \html{} document header.
  \item When not present the date is left empty. The \verb+\today+
command generates an empty date.
\end{itemize}

The \verb+abstract+ environment is present is all base styles,
including the \filename{book} style.
The \verb+titlepage+ environment does nothing.

\section{Displayed Paragraphs}
Displayed-paragraph environments translate to block-level
\html-elements.

\subsection{Quotation and Verse}
The \verb+quote+ and \verb+quotation+ are the same thing: the
translate to \verb+<BLOCKQUOTE>+ elements.
The \verb+verse+ environment is not supported.

\subsection{List-Making environments}
The \verb+itemize+, \verb+enumerate+ and \verb+description+
environments translate to the \verb+<UL>+, \verb+<OL>+, and
\verb+<DL>+ elements.
There is no control over the default item labels in an \verb+itemize+
or on numbering in a \verb+enumerate+ environment. The
\verb+\labelitemi+\ldots commands and \verb+enumi+\ldots  counters are
not defined.

\subsection{The \protect\texttt{list} and \protect\texttt{trivlist}
environments}
The \verb+list+ environment translates to the
\verb+<DD COMPACT=compact>+ element.
Arguments to \verb+\begin{list}+ are handled as follows:

\begin{flushleft}
\quad\verb+\begin{list}{+{\it default\_label}\verb+}{+{\it decls}\verb+}+
\end{flushleft}

The first argument {\it default\_label} is the label generated by an
\verb+\item+ command with no argument.
The second argument, {\it decls} is a sequence of declarations.
In practice, the following declarations are useful:
\begin{list}{}{}
\item[\texttt{\char92 usecounter\{}\textit{counter}\texttt{\}}]
The counter {\it counter} is incremented by \verb+\refstepcounter+
before every \verb+\item+ command with no argument.
\item[\texttt{\char92 renewcommand\{\char92
makelabel\}[1]\{}\ldots\texttt{\}}]
The command \verb+\item+ executes
\verb+\makelabel{+{\it label}\verb+}+, where {\it label} is the item
label, to print its label.
Thus, users can change label formatting by redefining
\verb+\makelabel+.
The default defining of \verb+\makelabel+ simply processes {\it
label}.
\end{list}

As an example, lists with user-defined conter can be defined as
follows:
\begin{verbatim}
\newcounter{coucou}
\begin{list}{\thecoucou}{%
\usecounter{coucou}%
\renewcommand{\makelabel}[1]{#1.}}
...
\end{list}
\end{verbatim}
This yields:
\newcounter{coucou}
\begin{list}{\thecoucou}{\usecounter{coucou}\renewcommand{\makelabel}[1]{#1.}}
\item First item.
\item Second item.
\end{list}


The \verb+trivlist+ environment is also supported. It translates to a
\verb+<DL>+ element.

\subsection{Verbatim}

The \verb+verbatim+ and \verb+verbatim*+ environments translate to
the \verb+<PRE>+ element. There is no difference between
\verb+verbatim+ and \verb+verbatim*+.

Similarily, \verb+\verb+ and \verb+\verb*+ are the same and they
translate to the \verb+<CODE>+ text element.

The \verb+alltt+ environment is supported, but no extensive testing of
it has yet been performed. Surprises are likely.

\section{Mathematical Formulas}

\subsection{Math Mode Environment}
The three ways to use math mode (\verb+$+\ldots\verb+$+,
\verb+\(+\ldots\verb+\)+ and
\verb+\begin{math}+\ldots\verb+\end{math}+ are supported.
The three ways to use display math mode (\verb+$$+\ldots\verb+$$+,
\verb+\[+\ldots\verb+\]+ and
\verb+\begin{displaymath}+\ldots\verb+\end{displaymath}+ are also
supported.
Futhermore, \verb+\ensuremath+ behave as expected.


The \verb+equation+, \verb+eqnarray+, \verb+eqnarray*+ environements
are supported.
Equation labeling and numbering is performed in the first two
environments, using the \verb+equation+ counter.
Additionnally, numbering can be suppressed in one row of an
\verb+eqnarray+, using the \verb+\nonumber+ command.


Math mode is not as powerful in \hevea{} as in \LaTeX{}.  The
limitations of math mode can often be surpassed by using math display
mode.  As a matter of fact, math mode is for in-text formulas. From
the \html{} point of view, this means that math mode does not close
the current flow of text and that formulas in math mode must be
rendered using text-level elements only.  By contrast, displayed
formulas can be rendered using block-level elements.  This means that
\hevea{} have much more possibilities in display context than inside
normal flow of text.  In particular, stacking text elements one above
the over is possible only in display context.
\begin{htmlonly}
For instance compare how \hevea{} renders
\verb+$\frac{1}{\sum_{i=1}^{\infty}$+
as: $\frac{1}{\sum_{i=1}^{\infty} i^i}$, and 
\verb+$$\frac{1}{\sum_{i=1}^{\infty}$$+ as:
$$\frac{1}{\sum_{i=1}^{\infty} i^i}$$
\end{htmlonly}


\subsection{Common Structures}

\hevea{} admits, subscript (\verb+_+), superscripts (\verb+^+) and
fractions (\verb+\frac{+{\it numer}\verb+}{+{\it denom}\verb+}+).
The best effect is obtained in display mode, where \html{}
\verb+<TABLE>+ element is extensiveley used. However, in-text
simple subscript and superscript are rendered using the \verb+<SUB>+
and \verb+<SUP>+ text-level elements and their appearance should be correct
both in in-text and displayed  formulas.

The n$^{\mbox{th}}$ root command \verb+\sqrt+ is not supported.


An attempt is made to render all ellipsis constructs (\verb+\ldots+,
\verb+\cdots+, \verb+\vdots+ and \verb+\ddots+). The effect may be
strange for the latter two.

\subsection{Mathematical symbols}
Symbols that can be printed using browser iso-latin or symbol fonts
are translated.
Other symbols are undefined most of the time.
Attempting to translate them will thus generate ``Unknown macro''
warnings.
Then, users can choose their own replacement for these symbols.
These personal definitions are best placed in an ad-hoc style file,
given as a command line argument to \hevea{}.
A suggested replacement is a mix of colors and available
symbols.
\begin{htmlonly}
For instance, \hevea{} cannot render the \verb+\leadsto+ symbol, it
can be defined as a red arrow  by:
\begin{verbatim}
\newcommand{\leadsto}{{\red\rightarrow}}
\end{verbatim}
Then, \verb+A \leadsto B+ is rendered as follows:
$$\newcommand{\leadsto}{{\red\rightarrow}}
A \leadsto B
$$
\end{htmlonly}

When given the \verb+-nosymb+ option, \hevea{} silently replaces
symbols that cannot be rendered by isolatin1 only by text equivalents.
These equivalents are english words by default, or french words when the
\verb+-francais+ option is set.

Log-like functions and variable sized-symbols are recognized and their
subscripts and superscripts are put where it belongs in display mode.
Default typesetting of subscripts can be changed using the
\verb+\limits+ and \verb+\nolimits+ commands.
Big delimiters are also handled.

\subsection{Putting one thing above the other}
The commands \verb+\stackrel+,  \verb+\underline+ and \verb+\overline+
are recognized.
They produce sensible output in display mode.
In text mode, these macros call the \verb+\textstackrel+,
\verb+\textunderline+ and \verb+\textoverline+ macros.
These macros perform the following default actions, which can be
changed by redefining them:
\begin{description}
\item[\texttt{\char92 textstackrel}] Performs ordinary superscripting.
\item[\texttt{\char92 textunderline}] Underlines its argument, using the
\html{} \verb+<U>+ text-level element.
\item[\texttt{\char92 textoverline}] Sends a warning message to the
console and echoes its argument in the output.
\end{description}

Math accents (\verb+\hat+, \verb+\tilde+, etc.) are not handled at
all.

\subsection{Spacing}\label{spacemath}
By contrast with \LaTeX{}, spaces matters in math mode.
One or more spaces are translated to one space inside text and to one
non-breaking space in display mode.
Futhermore,
spaces after commands (such as \verb+\alpha+) are echoed
except for invisible commands (such as \verb+\tt+).
This allows users to control space in their formulas, output being
near to what can be expected.

Explicit spacing commands (\verb+\,+, \verb+\!+, \verb+\:+ and
\verb+\;+) are recognized, the first two commands do nothing, while
the two others output one space.

\subsection{Changing Style}

Letters are always italicized inside math mode and this cannot be
changed. The appearence of
other symbols can be changed using
\LaTeX2e{} style changing commands (\verb+\mathrm+, etc.).
The commands \verb+\boldmath+ and \verb+\unboldmath+ are not
recognized. Wether symbols belonging to the symbol font are affected
by these changes or not is browser dependant.

Observe that this does not corresponds directly to how \LaTeX{} manage style
in maths.

Math style changing declarations \verb+\displaysyle+ and \verb+\textstyle+
do not exist, while \verb+\scriptstyle+ and \verb+\scriptscriptstyle+
perform type size changes.

\section{Definitions, Numbering}

\subsection{Defining Commands}\label{usermacro}

{\hevea} understands macro definitions given in {\LaTeX} style (using
\verb+\newcommand+, \verb+\renewcommand+ and \verb+\providecommand+).
These three instructions accept the same arguments and have the same
meaning as in {\LaTeX}. However, {\hevea} is more tolerant: if macro
{\it name} already exists, then a subsequent \verb+\newcommand{+{\it
name}\verb+}+ is ignored.  If macro {\it name} does not exists, then
\verb+\renewcommand{+{\it name}\verb+}+ performs a definition of {\it
name}.  In both cases, warnings are issued.

The behavior of \verb+\newcommand+ allows to shadow document
definition, provided the new definitions are processed before the
document definitions.
This is easily done by grouping the shadowing definition  in a
specific style file given as an argument to {\hevea}.
By contrast, changes of base macros (i.e. the ones that {\hevea}
defines before loading any user-specified file) must be performed
using \verb+\renewcommand+. Such personal (re)-definition can be made
in any user file.


{\hevea} also accepts simple {\TeX} style (using \verb+\def#1#2...+
without delimiting 
characters), with the same behavior as \verb+\newcommand+.
It also processes a
limited version of \verb+\let+:

\begin{flushleft}
\verb+\let+ {\it macro-name} \verb+=+ {\it macro-name}
\end{flushleft}

Scoping rules apply to macros, as they do in {\LaTeX}.
You can escape them by using the {\TeX} constructs
\verb+\gdef+, \verb+\global\def+ and \verb+\global\let+


\subsection{Defining Environments}
\hevea{} accepts environment definitions and redefinitions
by \verb+\newenvironment+ and \verb+\renewenvironment+.
New theorem-like environments can also be introduced and redefined,
using \verb+\newtheorem+ and \verb+\renewtheorem+.
The support is complete and should conform
to~\cite[section~C.8.2 and~C.8.3]{latex}.

Note that environments are local to the block
they are defined into,
while  theorem-like environment definitions  are global.

\subsection{Numbering}
{\LaTeX} counters are (fully ?) supported. \TeX{} style is not
supported.

\section{Figures and Other Floating Bodies}

Figures and tables are put where they appear in source, regardless of
their placement arguments.
They are outputed  inside a \verb+<BLOCKQUOTE>+ element and they are
separated from enclosing text by two
horizontal rules.

Captions and cross referencing are handled.
The \verb+\suppressfloats+ command does nothing and the
figure related counters (such as \verb+topnumber+) exist but are useless.

Marginal notes are not handled and the \verb+\marginpar+ command does
not exist.

\section{Lining It Up in Columns}
\subsection{The \protect\texttt{tabbing} Environment}
Limited support is offered.
The \texttt{tabbing} environment translate to a flexible \texttt{tabular}-like
environment.
Inside this environment, the command \verb+\kill+ ends a row, while
commands
\verb+\=+ and \verb+\>+ start a new column.
All other tabbing commands do not even exist.

\subsection{The \protect\texttt{array} and \protect\texttt{tabular}
environments}

This environemnts are partially supported, using \html{}
\verb+<TABLE>+, however rendering is
satifactory in simple cases.
Arrays can nest. By contrast with \LaTeX{}, arrays implictely open
display mode and array items are typeset in display mode.



Some \LaTeX{} array features are not supported at all:
\begin{itemize}
\item Optional arguments to \verb+\begin{array}+ and
\verb+\begin{tabular}+ are ignored.
\item The command \verb+\vline+ does not exists.
\end{itemize}

Some others are partly rendered:
\begin{itemize}
\item Spacing between columns is different. In particular, some space
appears around \verb+@+ formatting specification.
\item The \verb+p{+{\it wd}\verb+}+ column specification is equivalent
to \verb+l+ with word wrap enabled.
\item If a \verb+|+ appears somewhere in the column formatting
specification, then the array is shown with borders.
\item The command \verb+\hline+ does nothing if the array has borders
(see above). Otherwise, an horizontal rule is outputed.
\item The command \verb+\cline+ ignores its argument and is equivalent
to \verb+\hline+.
\item The \verb+tabular*+ environment is rendered as an ordinary
\verb+tabular+.
(A warning is issued).
Its first argument is ignored.
\item Similarily the command
\verb+\extracolsep+ issues a warning and ignores its argument.
\end{itemize}

There is an additional feature: if ``\verb+t+'' appears before a
column format (\verb+c+, \verb+l+ or \verb+r+), then the corresponding
column is typeset after exiting math-mode.
This additional feature enables the encoding of \TeX{} \verb+\cases+ using
the \LaTeX{} arrays.
The command \verb+\cases+ is defined in \filename{hevea.sty}.

\section{Moving Information Around}
\subsection{Files}
\hevea{} can use some of the ancillary files generated by \LaTeX{} in
order to output better looking cross-references.
In practice, while processing file \filename{mydoc\texttt{\textup{.tex}}}, the following
files may be read:
\begin{description}
\item[.aux] The file \filename{mydo}\texttt{.aux} contains
cross-referencing informations, such as figure or section numbers.
If this file is present, \hevea{} reads it and put such numbers (or
labels) inside
the links generated by the \verb+\ref+ command. If the \texttt{.aux}
file is not present, all such numbers are
replaced by ``X''.
\item[.bbl] The file \filename{mydoc}\texttt{.bbl} is generated by
\BibTeX{}. It is read by the \verb+\bibliography+ command.
\item[.idx] The file \filename{mydoc}\texttt{.idx} is normally not
read by \hevea{}, which does its own index computations.
Some user modify \filename{.idx} files before running
\verb+makeindex+, for instance to sort index entries taking
non-english diacritics into account.
{\hevea} can read such files and use the index entry labels they define,
provided it is given the \verb+-idx+ option.
Thus, if you follow such a scheme on \filename{mydoc}\texttt{.tex}, first run
{\LaTeX}, process \filename{mydoc}\texttt{.idx} and invoke \hevea{} with the
\verb+-idx+ option set.
\end{description}

\hevea{} does not fail when it cannot find an auxilary file.

\subsection{Cross-References}
The {\LaTeX} \verb+\label+ and \verb+\ref+ are changed by {\hevea}
into {\html} anchors and local links.
Additionnaly, numerical references to sectional units, figures,
tables, etc. are shown, as they would appear in the \texttt{.dvi} file,
provided a \texttt{.aux} file exists.
Numerical references to pages (such as generated by \verb+\pageref+)
are not shown; only an link is generated.

Thus, to get the cross references right in a document,
\filename{mydoc.tex}, you should first generate an 
up-to-date \filename{mydoc.aux} file by running {\LaTeX} as many times
as necessary.
If no \filename{mydoc.aux} exists,  all references are shown as
``X''.
If a non-correct \filename{mydoc.aux} file is present, then cross
references will apparently be wrong. However the links are correct in
both cases.

\subsection{Bibliography and Citations}
The \verb+\cite+ macro is supported. Its optional argument is
correctly handled. Citation labels are extracted from the
\texttt{.aux} file, if present. Otherwise the argument to
\verb+cite+ is used.

The \verb+\bibliography+ command is
recognized, it loads the \texttt{.bbl} file which should thus
have been generated before, using the appropriate combination of
\LaTeX{} and \BibTeX{} runs.

The \verb+thebibliography+ environment is recognized.

The \verb+\nocite+ and \verb+\bibliographystyle+ macros exist and do
nothing.

\subsection{Splitting the Input}

The \verb+\input+ and \verb+\include+ commands exist are they perform
exactly the same operation of searching a file (see~\ref{files}).
Let  \filename{filename} be the argument to \verb+\input+ or
\verb+\include+.
A file is searched following this scheme:
\begin{itemize}
\item If \filename{filename} is an absolute path, then \hevea{}
attempt to open a file with this name exactly.
\item Otherwise, \hevea{} searches a file with name
\filename{filename} in all the directories in its search path. (See
\ref{path} for the definition of \hevea{} search path).
\end{itemize}
Additionnaly, if \filename{filename}
does not have an
extension and that a first attempt to find it fails, then a second
attempt is made, looking for file \filename{filename}\texttt{.tex}.


The \verb+\includeonly+ and \verb+\lisfiles+ commands are null commands.

\hevea has a search path, which is defined as, first, the current
directory \verb+.+, followed by the directories given as
arguments to the \verb+-I+ option, and last \hevea{} instalatio
directory (e.g., \verb+/usr/local/lib/hevea+).


\subsection{Index and Glossary}
\hevea{} supports several simultaneaous indexes, following the scheme
of the
\url{ftp://theory.lcs.mit.edu//pub/tex/index/}{\filename{index}} style,
which is present in modern \LaTeX{} distributions.
This scheme is backward compatible with the standard indexing scheme
of \LaTeX.
Observe that \hevea{} does its own index computation  and does not need
\verb+makeindex+.

More precisely, \hevea{} knows the following commands:
\begin{description}
\item[{\tt\char92 newindex\{}{\it tag}{\tt \}\{}{\it
ext}{\tt\}\{}{\it ignored}{\tt\}\{}{\it indexname}{\tt\}}]
Declare an index.
The first argument {\it tag} is a tag to select this index in other
commands; {\it ext} is the extenstion of the index information file
generated by \LaTeX{} (e.g., \verb+idx+); {\it ignored} is ignored by
\hevea{}; and {\it indexname} is the title of the index.
If given the \verb+idx+ option. \hevea{} attempts to read file
\filename{mydoc}\texttt{.}{\it ext}. There also exists a
\verb+\renewindex+ commands that takes the same arguments and that can be
used to redefine previously declared indexes.
\item[{\tt\char92 makeindex}] Perform
\verb+\newindex{default}{idx}{ind}{Index}+.
\item[{\tt\char92 index[}{\it tag}{\tt]\{}{\it arg}{\tt\}}]
Act as the \LaTeX{} \verb+\index+ command except that the information
extracted from {\it arg} goes to the {\it tag} index.
The {\it tag} argument defaults to \verb+default+, thereby yielding
standard \LaTeX{} behavior for the \verb+\index+ command without an
optional argument.
There also exists a stared-variant \verb+\index*+ that additionnaly
typesets {\it arg}.
\end{description}

Glossaries are not handled (who uses them ?) and the \verb+theindex+
environment does not 
exist (since \hevea{} computes its own indexes).

\subsection{Terminal Input and Output}

The \verb+\typeout+ command echos its argument verbatim on the
terminal.
The \verb+\typein+ command is not supported.

\section{Line and Page Breaking}

\subsection{Line Breaking}
The advisory line breaking commands \verb+\linebreak+ and
\verb+\nolinebreak+ are null commands.

The \verb+\\+ and \verb+\\*+ commands output a \verb+<BR>+ element,
except inside arrays where the close the current row.
Their option argument is ignored.
The \verb+\newline+ outputs a \verb+<BR>+ element.

All other line breaking commands, declarations or environemnts are
silently ignored.

\subsection{Page Breaking}
They are no pages in the physical sense in \html. Thus all these
commands are ignored.

\section{Lengths, Spaces and Boxes}
\subsection{Length}
All length are ignored, things go smoothly when \LaTeX{} syntax is
used (using the \verb+\newlength+, \verb+\setlength+, etc. commands
which are null macros).
Of course, if length are really important to the document, rendering
will be poor.

Note that \TeX{} length syntax is not at all recognized. As a
consequence, writting things like \verb+\textwidth=10cm+ will clobber
the output.
Users can correct such misbehavior by adopting \LaTeX{} syntax
(\verb+\setlength{\textwidth}{10cm}+ here).


\subsection{Space}
The \verb+\hspace+, \verb+\vspace+ and \verb+\addvspace+ spacing
commands and their
starred versions do nothing but issuing a warning.

It is so because \hevea{} cannot interpret length arguments.  When a
document uses these commands once or always with similar arguments,
users can redefine them to output the desired amount of non-breaking
spaces or line-skips (which can be none of course). 


However, spacing commands without arguments are recognized.
The \verb+\enspace+, \verb+\quad+ and \verb+\qquad+ commands output
one, two and four non-breaking spaces, while the \verb+\smallskip+,
\verb+\medskip+ and \verb+\bigskip+ ouput one, one, and two line
breaks.

Strechable lengths do not exist, thus the \verb+\hfill+ and
\verb+\vfill+ macros are undefined.

\subsection{Boxes}

Box contents in typeset in text mode (i.e., non-math and non-display
mode).
Both \LaTeX{} boxing commands \verb+\mbox+ and \verb+\makebox+
commands exist.
However  \verb+\makebox+ generates a specific warning, since \hevea{}
ignore the length and positioning instructions given as optional
argument.

Similarily, the boxing with frame \verb+\fbox+ and \verb+\framebox+
commands are recognized and
\verb+\framebox+ issues a warning.
Additionnally, \verb+\fbox+ reduces to \verb+\mbox+ in non-display
mode and no frame is drawn.

Boxes can be saved for latter usage by storing them in {\em bin}.
New bins are defined by \verb+\newsavebox{+{\it cmd}\verb+}+.

Then some text can be saved into {\it cmd} by
\verb+\sbox{+{\it text}\verb+}{+{\it cmd}\verb+}+.
The text is translated to \html{}, as if it was inside a \verb+\mbox+
and the resulting output is stored.
It is retrieved (and outputed) by the command
\verb+\usebox{+{\it cmd}\verb+}+.
The \verb+\savebox+ command reduces to \verb+\sbox+, ignoring its
optional arguments.

The \verb+\rule+ commands translate to a \html{} horizontal rule
(\verb+<HR>+)  regardless of its arguemts.


All other box-related  commands do not exist.

\section{Font selection}

\subsection{Changing the Type Style}
All \LaTeX2e{} declarations and environments for changing type style
are recognized. Aspect is rather like \LaTeX2e{} output, but there is
no guarantee.
Old style declarations are also recognized, they
should yield the same
appearence as corresponding new declarations.

\hevea{} possesses an extra font attribute: color.
Text color is changed by declarations whose names follows \html{}
conventions for colors.
There are sixteen predefined colors:
\begin{center}
\begin{tabular}{p{.7\linewidth}}
%HEVEA\purple
\verb+\purple+,
%HEVEA\silver
\verb+\silver+,
%HEVEA\gray
\verb+\gray+,
%HEVEA\white
\verb+\white+,
%HEVEA\maroon
\verb+\maroon+,
%HEVEA\red
\verb+\red+,
%HEVEA\fuchsia
\verb+\fuchsia+,
%HEVEA\green
\verb+\green+,
%HEVEA\lime
\verb+\lime+,
%HEVEA\olive
\verb+\olive+,
%HEVEA\yellow
\verb+\yellow+,
%HEVEA\navy
\verb+\navy+,
%HEVEA\blue
\verb+\blue+,
%HEVEA\teal
\verb+\teal+,
%HEVEA\aqua
\verb+\aqua+
\end{tabular}
\end{center}
Additionaly, the current text color can be changed by the declaration
\verb+\htmlcolor{+{\it number}\verb+}+, where {\it number} is a six
digit hexdecimal number specyfing a color in the RGB space.
For instance, the following declarations change font color to dark gray:
%HEVEA{\htmlcolor{404040}%
\begin{verbatim}
  \htmlcolor{404040}
\end{verbatim}
%HEVEA}

Colors should be used carefully. Two many colors
hinders clarity and some of the colors may not be readable on the
document backgroud color.

\subsection{Changing the Type Size}
All declarations, from \verb+\tiny+ to \verb+\Huge+ are recognized.
Output is not satisfactory inside headers elements, as generated, for
instance, 
by sectionning commands.

\subsection{Special Symbols}

The \verb+\symbol{+{\it num}\verb+}+ outputs character number {\it num}.
In practice, this is a way to output any character from the isolatin1
character set.


\part{Practical information}

\section{Usage}
\begin{verbatim}
# hevea -help
hevea 0.0
  -v , verbose flag, can be repeated to increase verbosity
  -e filename, prevent file ``filename'' from being read
  -idx , attempt to read .idx file (useful if indexing is non-standard)
  -francais , french mode
  -nosymb , do not output symbol fonts
  -I dir, add directory ``dir'' to search path
  -o filename, make hevea output go into file ``filename''
\end{verbatim}

\begin{verbatim}
# htmlcut 0.0
  -o filename, make htmlcut output go into file ``filename'' (defaults to index.html)
\end{verbatim}


\section{Browser configuration}\label{browser}

\subsection{Netscape}
\begin{description}
\item[Unix]
For Netscape, add the following line to
your \filename{.Xdefaults} file 
\begin{verbatim}
Netscape*documentFonts.charset*adobe-fontspecific:   iso-8859-1
\end{verbatim}
(Then, you probably need something like a \commandname{xrdb} command before
you start Netscape.)
\item[Macintosh]
Choose  {\bf Roman-Encodings} in the item {\bf Document~Encoding}
from {\em Preferences} menu.
\end{description}

\section{Installation}


\subsection{Requirements}

The programs \commandname{hevea} and \commandname{htmlcut} are written in
\url{http://caml.inria.fr/ocaml/}{Objective Caml}. Thus, you
really need Objective Caml to compile it.

{\hevea} extract referencing information for \filename{.aux} files,
and bibliographic information from \filename{.bbl} files.
Hence you need a fully functional {\LaTeX} system to get the right
cross reference labels in {\hevea} output.
Additionnaly, the {\hevea} user may instruct the program not to process a
part of the input (see section~\ref{imagegen}). Instead, this part is
processed into a 
\verb+.gif+ file and {\hevea} ouputs a  link to the image file.
\LaTeX\ is changed into a \verb+.gif+ file by the the \verb+imagegen+
script, which basically calls, \LaTeX, ghostscript a few tools from
the image processing package
\url{ftp://wuarchive.wustl.edu/graphics/graphics/packages/NetPBM}{netpbm}.
To benefit from the full functionnality of \hevea, you need all
this software. However, {\hevea} runs without them, but then you will
have to accept ``X'' labels and to manage to produce images by yourself.

\subsection{Principles}
The details are given in the \verb+README+ file in the distribution.

\begin{thebibliography}{xxxxxx}
\bibitem[\LaTeX]{latex}
L. Lamport.
\newblock {\em A Document Preparation System System, {\LaTeX}, User's
Guide and Reference Manual}.
\newblock Addison-Websley, 1994.
\bibitem[\LaTeX]{latex}

\end{thebibliography}

\end{document}


Hopefully, \hevea understands most of \LaTeX base macros and environments.
This includes positionning environemnts such as \verb+center+,
\verb+flushleft+ or \verb+quote+; sectioning commands, such as
\verb+\section+; most of font atribute
changes such as \verb+\em+, \verb+\tt+, \verb+\large+ and the
associated environements; math mode as introduced by \verb+$+ and
display mode as introduced by \verb+$$+\ldots; subscripting and
superscriting; many math symbols, such as \verb+\in+ ($\in$) or
\verb+\leftarrow+ ($\leftarrow$); array and tabular
environmnents; cross references, figures, indexes, footnotes and
bibliographic references are
also handled. Again, I made some choices while mapping \LaTeX\
constructs onto {\html} and some part of them can be modified by
rewriting macros and environments in \LaTeX.

The {\html} implementation of some nasty \TeX\ or \LaTeX\ constructs such
as \verb+\over+, \verb+\left...\right+ or limits would deserve a more
thorough description. Some others such as the \verb+tabbing+ environment would
deserve a more thourough implementation.
Some may have deserved an implementation, such as \verb+\sqrt+\ldots\ 
I will not say more about them, you are invited to experiment and send
your remarks or critics to \mail{Luc.Maranget}{inria.fr}.
You can also have a look at {\hevea} test suite, see \urlex{suite.tex}
and \urlex{suite.html}.

